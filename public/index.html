<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Travel Summary</title>
  <style>
    body {
      font-family: sans-serif;
      max-width: 700px;
      margin: 2rem auto;
      line-height: 1.6;
      background-color: #fafafa;
      color: #545454;
    }

    .highlight {
      font-weight: bold;
      color: #2a2a2a;
    }

    .block {
      margin-bottom: 2rem;
    }

    #summary {
      color: #444; /* dark grey */
    }
  </style>
</head>
<body>
  <h1>Your Travel Summary</h1>

  <div class="block">
    <h2>Input Data</h2>
    <p><span class="highlight">Searches:</span></p>
    <ul>
      <li><span class="highlight">Barcelona</span> – June 28, 2025 – Filters: <span class="highlight">pool</span>, <span class="highlight">4 stars</span></li>
      <li><span class="highlight">Mallorca</span> – July 1, 2025 – Filters: <span class="highlight">sea view</span></li>
    </ul>

    <p><span class="highlight">Hotel Views:</span></p>
    <ul>
      <li><span class="highlight">Hotel Isla Mallorca</span> – 45s viewed – €120/night</li>
      <li><span class="highlight">Barceló Raval</span> – 70s viewed – €160/night</li>
    </ul>
  </div>

  <div class="block">
    <h2>AI Summary</h2>
    <p id="summary">Loading...</p>
  </div>

  <script>
    const keyTerms = ["Barcelona", "Mallorca", "Hotel Isla Mallorca", "Barceló Raval", "pool", "sea view", "4 stars"];

    fetch('/api/summary')
      .then(res => res.json())
      .then(data => {
        let summary = data.summary;

        // Highlight key terms in summary
        keyTerms.forEach(term => {
          const regex = new RegExp(`\\b(${term})\\b`, 'gi');
          summary = summary.replace(regex, '<span class="highlight">$1</span>');
        });

        document.getElementById('summary').innerHTML = summary;
      })
      .catch(err => {
        document.getElementById('summary').innerText = err;
        console.error(err);
      });
  </script>

<div class="block">
  <p style="font-size: 0.85rem; color: #888; line-height: 1.4;">
    This summary was generated by an AI model (OpenAI GPT) using your recent travel searches and hotel views. It analyzes destinations, filters, and preferences to suggest what kind of trip you're dreaming of.<br><br>
    <strong>Prompt used:</strong> <br>
    <em>
      You are a smart travel assistant. Here is the user's recent hotel interaction data:<br><br>

      Searches:<br>
      - Destination: Barcelona, Date: 2025-06-28, Filters: pool, 4 stars<br>
      - Destination: Mallorca, Date: 2025-07-01, Filters: sea view<br><br>

      Hotel views:<br>
      - Hotel: Hotel Isla Mallorca, Time viewed: 45s, Price per night: €120<br>
      - Hotel: Barceló Raval, Time viewed: 70s, Price per night: €160<br><br>

      Based on this data, generate a short, personalized and inspiring travel summary as if you're suggesting what kind of vacation they are dreaming of.
    </em>
  </p>
</div>


</body>
</html>
